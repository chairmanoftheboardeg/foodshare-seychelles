<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>FoodShare Seychelles</title>
  <link rel="icon" href="image/logo.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root{
      --brand:#4CAF50;
      --brand-dark:#1B5E20;
      --brand-deep:#0F3D14;
      --accent:#2196F3;

      --bg:#f4f6f5;
      --card:#ffffff;
      --text:#122013;
      --muted:#5b6a5f;
      --border:#e3e9e5;

      --radius:14px;
      --shadow:0 10px 30px rgba(10, 20, 12, .10);

      --max:1080px;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:inherit;text-decoration:none}
    a:hover{text-decoration:underline}

    .wrap{max-width:var(--max); margin:0 auto; padding:0 18px}
    .spacer{height:18px}
    .sep{height:1px; background:var(--border); margin:14px 0}

    /* Top header + nav */
    .topbar{
      background:var(--brand-deep);
      color:#fff;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .topbar-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 0;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .brand img{
      width:34px; height:34px;
      border-radius:10px;
      background:#fff;
    }

    .navlinks{
      display:flex; gap:14px; align-items:center; flex-wrap:wrap;
      font-size:13px;
    }
    .navlinks a{opacity:.95}
    .navlinks a:hover{opacity:1}

    .authbox{display:flex; gap:10px; align-items:center}

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:9px 12px;
      border-radius:10px;
      border:1px solid transparent;
      font-weight:800;
      cursor:pointer;
      font-size:13px;
      white-space:nowrap;
    }
    .btn.light{background:#fff; color:var(--brand-deep)}
    .btn.outline{background:transparent; color:#fff; border-color:rgba(255,255,255,.25)}
    .btn.brand{background:var(--brand); color:#fff}
    .btn.danger{background:#D32F2F; color:#fff}

    /* Mobile nav select */
    .navselect{
      display:none;
      min-width:180px;
      padding:9px 10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.08);
      color:#fff;
      font-weight:800;
      outline:none;
    }
    .navselect option{color:#000}

    @media (max-width: 860px){
      .navlinks{display:none}
      .navselect{display:block}
    }

    /* Announcement bar under nav */
    .announce-wrap{
      background:#fff;
      border-bottom:1px solid var(--border);
    }
    .announce{
      display:none;
      padding:10px 0;
    }
    .announce-card{
      background:#EAF6EC;
      border:1px solid rgba(76,175,80,.35);
      border-radius:12px;
      padding:10px 12px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .announce-title{
      font-weight:900;
      color:var(--brand-dark);
      display:flex;
      gap:8px;
      align-items:center;
    }
    .announce-text{
      margin-top:4px;
      color:#234029;
      font-weight:700;
      font-size:13px;
    }

    /* Main sections layout */
    .section{padding:22px 0}
    .center{display:flex; justify-content:center}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }

    /* Hero card like screenshot */
    .hero-card{
      width:min(860px, 100%);
      background:linear-gradient(180deg, var(--brand-deep), var(--brand-dark));
      color:#fff;
      padding:34px 22px;
      text-align:center;
    }
    .hero-title{
      font-size:42px;
      line-height:1.12;
      font-weight:950;
      margin:0;
      letter-spacing:-.2px;
    }
    .hero-sub{
      max-width:640px;
      margin:14px auto 0;
      font-size:14px;
      opacity:.92;
      font-weight:650;
    }
    .hero-actions{
      margin-top:18px;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }
    .hero-actions .btn{font-size:13px}

    @media (max-width: 560px){
      .hero-title{font-size:32px}
      .hero-card{padding:26px 16px}
    }

    /* Purpose block */
    .title-center{
      text-align:center;
      max-width:760px;
      margin:0 auto;
    }
    .h2{
      margin:0;
      font-size:18px;
      font-weight:950;
      color:var(--brand-dark);
      letter-spacing:.2px;
    }
    .p{
      margin:10px auto 0;
      color:var(--muted);
      font-weight:650;
      font-size:13px;
    }

    /* Features container with 3 cards like screenshot */
    .features-wrap{
      width:min(860px, 100%);
      padding:18px;
    }
    .features-title{
      text-align:center;
      font-weight:950;
      color:var(--brand-dark);
      margin:0;
      font-size:16px;
      letter-spacing:.2px;
    }
    .features-grid{
      margin-top:14px;
      display:grid;
      grid-template-columns:repeat(3, minmax(0,1fr));
      gap:12px;
    }
    @media (max-width: 860px){
      .features-grid{grid-template-columns:1fr}
    }
    .feature{
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px;
      background:#fff;
    }
    .feature h3{
      margin:0;
      font-size:14px;
      font-weight:950;
      color:#14331a;
    }
    .feature p{
      margin:8px 0 0;
      font-size:13px;
      color:var(--muted);
      font-weight:650;
    }
    .feature a{
      display:inline-flex;
      margin-top:10px;
      font-size:13px;
      font-weight:900;
      color:var(--brand-dark);
    }

    /* CTA strip like screenshot bottom */
    .cta-strip{
      width:min(860px, 100%);
      background:var(--brand-dark);
      color:#fff;
      border:1px solid rgba(0,0,0,.06);
      border-radius:12px;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      box-shadow:var(--shadow);
    }
    .cta-strip b{font-weight:950}
    .cta-strip .btn{background:#fff; color:var(--brand-dark)}

    /* Footer like screenshot */
    footer{
      margin-top:26px;
      background:var(--brand-deep);
      color:#dfe8e1;
    }
    .footer-inner{padding:26px 0}
    .footgrid{
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr;
      gap:18px;
    }
    @media (max-width: 860px){
      .footgrid{grid-template-columns:1fr}
    }
    .foot-title{font-weight:950; color:#fff; margin:0}
    .footlink{display:block; padding:6px 0; color:#dfe8e1; opacity:.95; font-size:13px}
    .footlink:hover{opacity:1; text-decoration:none}
    .fineprint{
      border-top:1px solid rgba(255,255,255,.12);
      margin-top:18px;
      padding-top:14px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      font-size:12px;
      color:#c9d7ce;
    }

    /* Loading */
    .loading{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      background:rgba(244,246,245,.88);
      z-index:200;
    }
    .loadbox{
      background:#fff;
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px 14px;
      box-shadow:var(--shadow);
      display:flex; gap:10px; align-items:center;
    }
    .spin{
      width:18px;height:18px;border-radius:50%;
      border:3px solid #d7e7db;
      border-top-color:var(--brand);
      animation:sp .9s linear infinite;
    }
    @keyframes sp{to{transform:rotate(360deg)}}
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="topbar">
    <div class="wrap">
      <div class="topbar-inner">
        <a class="brand" href="./">
          <img src="image/logo.png" alt="logo" onerror="this.style.display='none'">
          <span>FoodShare Seychelles</span>
        </a>

        <!-- Desktop links -->
        <nav class="navlinks" aria-label="Primary">
          <a href="./">Home</a>
          <a href="available-food/">Find Food</a>
          <a href="donate-now/">Donate</a>
          <a href="volunteer-now/">Volunteer</a>
          <a href="our-impact/">Impact</a>
          <a href="about/">About</a>
          <a href="our-partners/">Partners</a>
          <a href="staff-login/">Staff</a>
        </nav>

        <!-- Mobile select -->
        <select class="navselect" id="navSelect" aria-label="Navigate">
          <option value="./">Home</option>
          <option value="available-food/">Find Food</option>
          <option value="donate-now/">Donate</option>
          <option value="volunteer-now/">Volunteer</option>
          <option value="our-impact/">Impact</option>
          <option value="about/">About</option>
          <option value="our-partners/">Partners</option>
          <option value="staff-login/">Staff Login</option>
        </select>

        <div class="authbox" id="authBox"></div>
      </div>
    </div>
  </header>

  <!-- Announcement (below nav) -->
  <div class="announce-wrap">
    <div class="wrap">
      <div class="announce" id="announceWrap">
        <div class="announce-card">
          <div>
            <div class="announce-title"><i class="fa-solid fa-bullhorn"></i> Announcement</div>
            <div class="announce-text" id="announceText"></div>
          </div>
          <button class="btn light" id="announceClose" type="button" aria-label="Close announcement">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="loading" id="loading">
    <div class="loadbox">
      <div class="spin"></div>
      <div>
        <div style="font-weight:950">Loading</div>
        <div style="font-size:12px;color:var(--muted);font-weight:700">Please wait…</div>
      </div>
    </div>
  </div>

  <!-- MAIN -->
  <main class="wrap">

    <!-- HERO -->
    <section class="section">
      <div class="center">
        <div class="card hero-card">
          <h1 class="hero-title">Rescuing Food. Serving Communities.</h1>
          <div class="hero-sub">
            FoodShare Seychelles connects donors with community members and coordinates pickup and delivery through staff and volunteers.
          </div>
          <div class="hero-actions">
            <a class="btn brand" href="available-food/"><i class="fa-solid fa-basket-shopping"></i> Find Food</a>
            <a class="btn light" href="donate-now/"><i class="fa-solid fa-hand-holding-heart"></i> Donate Now</a>
            <a class="btn outline" href="volunteer-now/"><i class="fa-solid fa-people-group"></i> Volunteer</a>
          </div>
          <div style="margin-top:14px; font-size:12px; opacity:.92; font-weight:700">
            Platform forms require login so we can reply via notifications. If you cannot sign in, email
            <a href="mailto:admin@foodshare-seychelles.online" style="text-decoration:underline; font-weight:950">admin@foodshare-seychelles.online</a>.
          </div>
        </div>
      </div>
    </section>

    <!-- PURPOSE -->
    <section class="section" style="padding-top:0">
      <div class="title-center">
        <h2 class="h2">Our Purpose</h2>
        <p class="p">
          We reduce food waste across Seychelles and improve access to essential support by making donation, claiming, and coordination simple and accountable.
        </p>
      </div>
    </section>

    <!-- FEATURES -->
    <section class="section" style="padding-top:0">
      <div class="center">
        <div class="card features-wrap">
          <h3 class="features-title">What You Can Do</h3>
          <div class="features-grid">
            <div class="feature">
              <h3>Find Food</h3>
              <p>Browse live listings and submit a claim for transport or self pickup.</p>
              <a href="available-food/">Browse listings</a>
            </div>
            <div class="feature">
              <h3>Donate Food</h3>
              <p>Submit donation details so staff can coordinate collection and distribution.</p>
              <a href="donate-now/">Donate now</a>
            </div>
            <div class="feature">
              <h3>Volunteer</h3>
              <p>Apply to support operations, logistics, coordination, and outreach.</p>
              <a href="volunteer-now/">Apply</a>
            </div>
          </div>

          <div class="sep"></div>

          <!-- Optional clean stats area -->
          <div style="display:flex; gap:14px; flex-wrap:wrap; justify-content:space-between; align-items:flex-end">
            <div>
              <div style="font-weight:950; color:var(--brand-dark)">Quick Snapshot</div>
              <div style="font-size:12px; color:var(--muted); font-weight:700; margin-top:4px">
                Some counts may be hidden by security until you sign in.
              </div>
            </div>
            <div style="display:flex; gap:14px; flex-wrap:wrap">
              <div style="min-width:160px">
                <div style="font-size:12px; color:var(--muted); font-weight:800">Available listings</div>
                <div id="kListings" style="font-size:28px; font-weight:950">0</div>
              </div>
              <div style="min-width:160px">
                <div style="font-size:12px; color:var(--muted); font-weight:800">Donations</div>
                <div id="kDonations" style="font-size:28px; font-weight:950">0</div>
              </div>
              <div style="min-width:160px">
                <div style="font-size:12px; color:var(--muted); font-weight:800">Claims</div>
                <div id="kClaims" style="font-size:28px; font-weight:950">0</div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- CTA STRIP -->
    <section class="section" style="padding-top:0">
      <div class="center">
        <div class="cta-strip">
          <div><b>Ready to contribute to food rescue in Seychelles?</b></div>
          <a class="btn" href="donate-now/"><i class="fa-solid fa-arrow-right"></i> Start a donation</a>
        </div>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer>
    <div class="wrap footer-inner">
      <div class="footgrid">
        <div>
          <div class="foot-title">FoodShare Seychelles</div>
          <div style="margin-top:10px; font-size:13px; color:#cfe0d4; font-weight:650">
            Contact (no login): <a href="mailto:admin@foodshare-seychelles.online" style="text-decoration:underline; color:#fff; font-weight:900">admin@foodshare-seychelles.online</a>
          </div>
          <div style="margin-top:8px; font-size:13px; color:#cfe0d4; font-weight:650">
            For platform replies and updates, please sign in and use the forms.
          </div>
        </div>

        <div>
          <div class="foot-title">Quick Links</div>
          <a class="footlink" href="./">Home</a>
          <a class="footlink" href="available-food/">Find Food</a>
          <a class="footlink" href="donate-now/">Donate</a>
          <a class="footlink" href="volunteer-now/">Volunteer</a>
          <a class="footlink" href="staff-login/">Staff Login</a>
        </div>

        <div>
          <div class="foot-title">Legal</div>
          <a class="footlink" href="privacy-policy/">Privacy Policy</a>
          <a class="footlink" href="terms-of-use/">Terms of Use</a>
          <a class="footlink" href="sitemap/">Sitemap</a>
        </div>
      </div>

      <div class="fineprint">
        <div>© <span id="yr"></span> FoodShare Seychelles</div>
        <div>Website by <a href="https://tylernicholasgroup.com/staff/tyler" target="_blank" rel="noreferrer" style="text-decoration:underline; color:#fff; font-weight:900">Tyler Nicholas</a></div>
      </div>
    </div>
  </footer>

  <script>document.getElementById("yr").textContent = new Date().getFullYear();</script>

  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabase = createClient(
      "https://edotvuleaydztulkxehe.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkb3R2dWxlYXlkenR1bGt4ZWhlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU2MDAyNDYsImV4cCI6MjA4MTE3NjI0Nn0.gDni31MI8twOpNmNcIpj1jGsra75eZ2iLL6gQM0i9lw"
    );

    const loading = document.getElementById("loading");
    const setLoading = (on)=> loading.style.display = on ? "flex" : "none";

    // Mobile nav select
    const navSelect = document.getElementById("navSelect");
    navSelect.value = "./";
    navSelect.addEventListener("change", ()=> location.href = navSelect.value);

    // Announcement
    const announceWrap = document.getElementById("announceWrap");
    const announceText = document.getElementById("announceText");
    document.getElementById("announceClose").addEventListener("click", ()=> {
      announceWrap.style.display = "none";
    });

    async function loadAnnouncement(){
      const { data, error } = await supabase.from("settings").select("announcement").eq("id",1).single();
      if(!error && data?.announcement){
        announceText.textContent = data.announcement;
        announceWrap.style.display = "block";
      }
    }

    // Auth buttons
    async function renderAuth(){
      const box = document.getElementById("authBox");
      const { data } = await supabase.auth.getSession();
      const s = data.session;

      if(!s){
        box.innerHTML = `
          <a class="btn outline" href="account/login/"><i class="fa-solid fa-right-to-bracket"></i> Login</a>
          <a class="btn light" href="account/signup/"><i class="fa-solid fa-user-plus"></i> Sign up</a>
        `;
      } else {
        box.innerHTML = `
          <a class="btn outline" href="account/dashboard/"><i class="fa-solid fa-user"></i> Dashboard</a>
          <button class="btn danger" id="logoutBtn" type="button"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
        `;
        document.getElementById("logoutBtn").onclick = async ()=>{
          setLoading(true);
          await supabase.auth.signOut();
          setLoading(false);
          location.reload();
        };
      }
    }

    async function loadCounts(){
      // If RLS blocks a count, we keep it at 0 (clean UI, no errors shown).
      const a = await supabase.from("food_listings").select("id",{count:"exact",head:true}).eq("is_available", true);
      if(!a.error && typeof a.count === "number") document.getElementById("kListings").textContent = a.count;

      const b = await supabase.from("donations").select("id",{count:"exact",head:true});
      if(!b.error && typeof b.count === "number") document.getElementById("kDonations").textContent = b.count;

      const c = await supabase.from("claims").select("id",{count:"exact",head:true});
      if(!c.error && typeof c.count === "number") document.getElementById("kClaims").textContent = c.count;
    }

    (async ()=>{
      await renderAuth();
      await loadAnnouncement();
      await loadCounts();
      supabase.auth.onAuthStateChange(()=>renderAuth());
    })();
  </script>
</body>
</html>
