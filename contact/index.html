<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact Us — FoodShare Seychelles</title>
  <link rel="icon" href="../assets/img/logo.png" />

  <style>
    :root{
      --bg:#fff; --surface:#f6f9f6; --text:#111827; --muted:#6b7280;
      --green-700:#2f7d32; --green-600:#3f9a3d; --green-400:#7bd64e;
      --border: rgba(17,24,39,.10); --shadow: 0 12px 30px rgba(17,24,39,.08);
      --radius:16px; --radius-sm:12px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background:var(--bg); color:var(--text); line-height:1.5}
    a{color:inherit}
    .container{width:min(1120px, calc(100% - 40px)); margin:0 auto}
    .page{min-height: calc(100vh - 200px);}

    .topbar{background:#fff;border-bottom:1px solid var(--border); position:sticky; top:0; z-index:50}
    .nav{display:flex;align-items:center;justify-content:space-between; gap:14px; padding:12px 0}
    .brand{display:flex;align-items:center; gap:10px; text-decoration:none}
    .brand img{width:44px;height:44px;border-radius:10px}
    .brand .name{font-weight:900}
    .navlinks{display:flex;align-items:center; gap:12px; flex-wrap:wrap; justify-content:flex-end}
    .nav-link{font-weight:800; text-decoration:none; color:var(--text); padding:8px 10px; border-radius:10px}
    .nav-link:hover{background:var(--surface)}
    .nav-btn{border:1px solid var(--border); background:#fff; border-radius:10px; padding:8px 10px; font-weight:800; cursor:pointer}
    .lang{display:flex;align-items:center; gap:8px}
    .lang select{padding:8px 10px; border-radius:10px; border:1px solid var(--border)}

    .badge{display:inline-flex; align-items:center; gap:8px; padding:6px 12px; border:1px solid var(--border); border-radius:999px; background:#fff; color:var(--green-700); font-weight:700; font-size:13px}
    .hero{padding:48px 0 28px}
    .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card-pad{padding:22px}
    .h1{font-size:46px; line-height:1.05; margin:12px 0}
    .h2{font-size:28px; margin:0 0 10px}
    .h3{font-size:18px; margin:0 0 8px}
    .p{margin:0 0 12px; color:var(--muted)}
    .small{font-size:13px; color:var(--muted)}
    .section{padding:28px 0}
    .grid-3{display:grid; grid-template-columns: repeat(3,1fr); gap:14px}
    @media (max-width: 900px){.grid-3{grid-template-columns:1fr}}

    .form{display:grid; gap:12px}
    .field{display:grid; gap:6px}
    label{font-weight:900; font-size:13px}
    input, select, textarea{padding:12px; border-radius:12px; border:1px solid var(--border); font:inherit; background:#fff}
    textarea{min-height:130px; resize:vertical}
    .btn{display:inline-flex; align-items:center; justify-content:center; padding:12px 16px; border-radius:12px; font-weight:900; border:1px solid var(--border); background:#fff; cursor:pointer}
    .btn.primary{background: linear-gradient(90deg,var(--green-600),var(--green-400)); color:#fff; border-color:transparent}
    .status{padding:12px; border-radius:12px; border:1px solid var(--border); background:var(--surface); color:var(--muted)}

    .assistant-fab{position:fixed; right:18px; bottom:18px; z-index:999; border:0; border-radius:999px; padding:12px 14px; box-shadow:var(--shadow); background:linear-gradient(90deg,var(--green-600),var(--green-400)); color:#fff; font-weight:900; cursor:pointer}
    .assistant-modal{position:fixed; right:18px; bottom:72px; width:min(420px, calc(100vw - 36px)); z-index:1000; border-radius:16px; background:#fff; border:1px solid var(--border); box-shadow:var(--shadow); overflow:hidden}
    .assistant-head{padding:14px; background:var(--surface); border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center}
    .assistant-body{padding:14px; max-height:360px; overflow:auto}
    .msg{padding:10px 12px; border-radius:12px; border:1px solid var(--border); margin-bottom:10px; white-space:pre-wrap}
    .msg.bot{background:var(--surface)}
    .assistant-foot{padding:12px; border-top:1px solid var(--border); display:flex; gap:10px}
    .assistant-foot input{flex:1; padding:12px; border-radius:12px; border:1px solid var(--border)}
    .hidden{display:none !important}

    .footer{margin-top:30px; background:#0b1220; color:#e5e7eb}
    .footer a{color:#e5e7eb; text-decoration:none}
    .footer a:hover{text-decoration:underline}
    .footer-top{padding:28px 0; border-bottom:1px solid rgba(255,255,255,.12)}
    .footer-grid{display:grid; grid-template-columns: 1.2fr 1fr 1fr 1fr; gap:16px}
    @media (max-width: 900px){.footer-grid{grid-template-columns:1fr 1fr}}
    .footer-title{font-weight:900; margin:0 0 8px}
    .footer-list{list-style:none; padding:0; margin:0; display:grid; gap:8px; color:#cbd5e1}
    .footer-bottom{padding:14px 0; display:flex; justify-content:space-between; gap:14px; flex-wrap:wrap; color:#cbd5e1}
    .madeby{display:flex; gap:6px; flex-wrap:wrap}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="container">
      <nav class="nav" aria-label="Primary">
        <a class="brand" href="../">
          <img src="../assets/img/logo.png" alt="FoodShare Seychelles logo" />
          <div>
            <div class="name">FoodShare Seychelles</div>
            <div class="small">Operational food rescue & access</div>
          </div>
        </a>

        <div class="navlinks">
          <a class="nav-link" href="../" data-i18n="nav_home">Home</a>
          <a class="nav-link" href="../about-us/" data-i18n="nav_about">About Us</a>
          <a class="nav-link" href="../learn/" data-i18n="nav_learn">Learn</a>
          <a class="nav-link" href="../our-impact/" data-i18n="nav_impact">Our Impact</a>
          <a class="nav-link" href="../our-partners/" data-i18n="nav_partners">Our Partners</a>
          <a class="nav-link" href="../social-media/" data-i18n="nav_social">Social Media</a>
          <a class="nav-link" href="../find-food/" data-i18n="nav_find_food">Find Food</a>
          <a class="nav-link" href="../donate-now/" data-i18n="nav_donate">Donate Now</a>
          <a class="nav-link" href="../volunteer-now/" data-i18n="nav_volunteer">Volunteer Now</a>
          <a class="nav-link" href="../contact-us/" data-i18n="nav_contact">Contact Us</a>

          <div class="lang">
            <select id="langSelect" aria-label="Select language">
              <option value="en">English</option>
              <option value="cr">Kreol Seselwa</option>
              <option value="fr">Français</option>
            </select>
          </div>

          <div id="navAuthArea"></div>
        </div>
      </nav>
    </div>
  </header>

  <main class="page">
    <section class="hero">
      <div class="container">
        <span class="badge">Support • Partnerships • Questions</span>
        <h1 class="h1">Contact Us</h1>
        <p class="p">For general questions, partnerships, or support, send a message below.</p>
      </div>
    </section>

    <section class="section">
      <div class="container grid-3">
        <div class="card card-pad" style="grid-column: span 2;">
          <h2 class="h2">Send a message</h2>
          <form class="form" id="contactForm">
            <div class="field">
              <label for="name">Name</label>
              <input id="name" name="name" required />
            </div>
            <div class="field">
              <label for="email">Email</label>
              <input id="email" name="email" type="email" required />
            </div>
            <div class="field">
              <label for="category">Category</label>
              <select id="category" name="category" required>
                <option value="general">General</option>
                <option value="partnership">Partnership</option>
                <option value="support">Support</option>
              </select>
            </div>
            <div class="field">
              <label for="message">Message</label>
              <textarea id="message" name="message" required></textarea>
            </div>

            <button class="btn primary" type="submit">Submit</button>
            <div class="status" id="contactStatus">Your message will be stored securely and reviewed by our team.</div>
          </form>
        </div>

        <div class="card card-pad">
          <h3 class="h3">Quick links</h3>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li><a href="../donate-now/">Donate Now</a></li>
            <li><a href="../find-food/">Find Food</a></li>
            <li><a href="../volunteer-now/">Volunteer Now</a></li>
            <li><a href="../learn/">Food safety guidance</a></li>
          </ul>

          <div style="height:1px;background:var(--border); margin:18px 0"></div>
          <h3 class="h3">Need help fast?</h3>
          <p class="p">Use the Assistant (bottom-right) for guidance and live public stats.</p>
        </div>
      </div>
    </section>
  </main>

  <button class="assistant-fab" id="assistantFab" type="button">Assistant</button>
  <div class="assistant-modal hidden" id="assistantModal" role="dialog" aria-modal="true" aria-label="FoodShare Assistant">
    <div class="assistant-head">
      <strong>FoodShare Assistant</strong>
      <button class="nav-btn" id="assistantClose" type="button">Close</button>
    </div>
    <div class="assistant-body" id="assistantBody"></div>
    <div class="assistant-foot">
      <input id="assistantInput" type="text" placeholder="Ask about donations, volunteering, impact…" />
      <button class="btn primary" id="assistantSend" type="button">Send</button>
    </div>
  </div>

  <footer class="footer">
    <div class="footer-top">
      <div class="container footer-grid">
        <div>
          <div class="footer-title">FoodShare Seychelles</div>
          <div class="small" style="color:#cbd5e1">Reducing food waste and improving food access through safe, coordinated logistics.</div>
        </div>
        <div>
          <div class="footer-title" data-i18n="footer_pages">Pages</div>
          <ul class="footer-list">
            <li><a href="../">Home</a></li>
            <li><a href="../about-us/">About Us</a></li>
            <li><a href="../learn/">Learn</a></li>
            <li><a href="../our-impact/">Our Impact</a></li>
            <li><a href="../our-partners/">Our Partners</a></li>
            <li><a href="../social-media/">Social Media</a></li>
          </ul>
        </div>
        <div>
          <div class="footer-title">Actions</div>
          <ul class="footer-list">
            <li><a href="../find-food/">Find Food</a></li>
            <li><a href="../donate-now/">Donate Now</a></li>
            <li><a href="../volunteer-now/">Volunteer Now</a></li>
            <li><a href="../contact-us/">Contact Us</a></li>
            <li><a href="../auth/">Sign Up / Login</a></li>
          </ul>
        </div>
        <div>
          <div class="footer-title">Legal</div>
          <ul class="footer-list">
            <li><a href="../privacy-policy/">Privacy Policy</a></li>
            <li><a href="../terms-of-use/">Terms Of Use</a></li>
            <li><a href="../sitemap/">Sitemap</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div>© <span id="yr"></span> FoodShare Seychelles</div>
      <div class="madeby">
        <span data-i18n="footer_madeby">Website made by</span>
        <a href="https://tylernicholasgroup.com/staff/tyler" target="_blank" rel="noopener">Tyler Nicholas</a>
      </div>
    </div>
  </footer>

  <script>document.getElementById("yr").textContent=new Date().getFullYear();</script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL='https://edotvuleaydztulkxehe.supabase.co';
    const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkb3R2dWxlYXlkenR1bGt4ZWhlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU2MDAyNDYsImV4cCI6MjA4MTE3NjI0Nn0.gDni31MI8twOpNmNcIpj1jGsra75eZ2iLL6gQM0i9lw';
    const sb=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY,{auth:{persistSession:true,autoRefreshToken:true,detectSessionInUrl:true}});

    async function getUser(){const {data}=await sb.auth.getUser(); return data?.user||null;}
    async function signOut(){await sb.auth.signOut();}

    const dict={
      en:{nav_home:"Home",nav_about:"About Us",nav_learn:"Learn",nav_impact:"Our Impact",nav_partners:"Our Partners",nav_social:"Social Media",nav_find_food:"Find Food",nav_donate:"Donate Now",nav_volunteer:"Volunteer Now",nav_contact:"Contact Us",nav_auth:"Sign Up / Login",nav_dashboard:"User Dashboard",nav_staff_login:"Staff Login",footer_pages:"Pages",footer_madeby:"Website made by"},
      cr:{nav_home:"Lakour",nav_about:"Kisisa Nou",nav_learn:"Aprann",nav_impact:"Nou Lenpakt",nav_partners:"Nou Bann Partner",nav_social:"Rezo Sosyal",nav_find_food:"Rod Manze",nav_donate:"Done Aster",nav_volunteer:"Vin Volunteer",nav_contact:"Kontak Nou",nav_auth:"Anrezistre / Konekte",nav_dashboard:"Dashboard",nav_staff_login:"Koneksyon Staff",footer_pages:"Paz",footer_madeby:"Sit web krwar par"},
      fr:{nav_home:"Accueil",nav_about:"À propos",nav_learn:"Apprendre",nav_impact:"Notre impact",nav_partners:"Nos partenaires",nav_social:"Réseaux sociaux",nav_find_food:"Trouver",nav_donate:"Faire un don",nav_volunteer:"Bénévolat",nav_contact:"Contact",nav_auth:"Inscription / Connexion",nav_dashboard:"Tableau de bord",nav_staff_login:"Connexion staff",footer_pages:"Pages",footer_madeby:"Site réalisé par"}
    };
    function getLang(){return localStorage.getItem("fs_lang")||"en";}
    function setLang(l){localStorage.setItem("fs_lang",l);}
    function t(k){const l=getLang(); return (dict[l]&&dict[l][k])||dict.en[k]||k;}
    function applyI18n(){document.querySelectorAll("[data-i18n]").forEach(el=>el.textContent=t(el.getAttribute("data-i18n")));}

    async function updateAuthArea(){
      const user=await getUser();
      const box=document.getElementById("navAuthArea");
      if(!box) return;
      if(!user){
        box.innerHTML=`
          <a class="nav-link" href="../auth/" data-i18n="nav_auth">Sign Up / Login</a>
          <a class="nav-link" href="../staff-login/" data-i18n="nav_staff_login">Staff Login</a>
        `;
        applyI18n(); return;
      }
      box.innerHTML=`
        <a class="nav-link" href="../dashboard/" data-i18n="nav_dashboard">User Dashboard</a>
        <button class="nav-btn" id="navSignOutBtn" type="button">Sign out</button>
      `;
      document.getElementById("navSignOutBtn").addEventListener("click", async ()=>{await signOut(); location.href="../auth/";});
      applyI18n();
    }

    // Assistant minimal (contact fallback)
    function addMsg(c,who,text){const d=document.createElement("div"); d.className="msg "+who; d.textContent=text; c.appendChild(d); c.scrollTop=c.scrollHeight;}
    async function assistantAnswer(qRaw){
      const q=String(qRaw||"").toLowerCase().trim();
      const contact="../contact-us/";
      if(!q) return `Ask about donating, volunteering, finding food, or impact. Contact: ${contact}`;
      if(q.includes("impact")||q.includes("stats")||q.includes("kg")||q.includes("co2")){
        const {data}=await sb.from("impact_public").select("*").maybeSingle();
        if(!data) return `Can't load live impact now. Contact: ${contact}`;
        return `Live impact:\n• KG rescued: ${Number(data.kg_rescued||0).toLocaleString(undefined,{maximumFractionDigits:1})} kg\n• Meals: ${Number(data.meals_estimated||0).toLocaleString()}`;
      }
      if(q.includes("find")||q.includes("listing")||q.includes("food")){
        const {data}=await sb.from("food_listings_public").select("title,pickup_area").order("created_at",{ascending:false}).limit(5);
        if(!data||data.length===0) return `No active listings right now. Contact: ${contact}`;
        return `Available listings:\n${data.map(i=>`• ${i.title}${i.pickup_area?" — "+i.pickup_area:""}`).join("\n")}\n\nFind Food: ../find-food/`;
      }
      if(q.includes("donate")) return `Donate: ../donate-now/.`;
      if(q.includes("volunteer")||q.includes("help")) return `Volunteer: ../volunteer-now/.`;
      return `Not sure. Please use Contact Us: ${contact}`;
    }
    function wireAssistant(){
      const fab=document.getElementById("assistantFab"), modal=document.getElementById("assistantModal"),
            closeBtn=document.getElementById("assistantClose"), body=document.getElementById("assistantBody"),
            input=document.getElementById("assistantInput"), send=document.getElementById("assistantSend");
      fab.addEventListener("click",()=>{modal.classList.remove("hidden"); if(body.childElementCount===0){addMsg(body,"bot","Hi — FoodShare Assistant. Ask about donations, volunteering, food, or impact.");} input.focus();});
      closeBtn.addEventListener("click",()=>modal.classList.add("hidden"));
      async function run(){const q=input.value; if(!q.trim()) return; addMsg(body,"user",q); input.value=""; send.disabled=true; try{addMsg(body,"bot",await assistantAnswer(q));}catch(e){addMsg(body,"bot","Error. Contact: ../contact-us/");}finally{send.disabled=false; input.focus();}}
      send.addEventListener("click",run); input.addEventListener("keydown",(e)=>{if(e.key==="Enter") run();});
    }

    // Contact form insert
    document.addEventListener("DOMContentLoaded", async ()=>{
      const sel=document.getElementById("langSelect");
      sel.value=getLang();
      sel.addEventListener("change",()=>{setLang(sel.value); applyI18n();});
      applyI18n();
      await updateAuthArea();
      wireAssistant();

      const form=document.getElementById("contactForm");
      const status=document.getElementById("contactStatus");

      form.addEventListener("submit", async (e)=>{
        e.preventDefault();
        status.textContent="Submitting…";

        const payload = {
          name: form.name.value.trim(),
          email: form.email.value.trim(),
          category: form.category.value,
          message: form.message.value.trim(),
          status: "open",
          admin_notes: null
        };

        const { error } = await sb.from("inquiries").insert(payload);
        if (error){ status.textContent = "Error: " + error.message; return; }

        form.reset();
        status.textContent = "Thank you. Your message has been received. We will respond as soon as possible.";
      });
    });
  </script>
</body>
</html>
