<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - FoodShare Seychelles</title>
    
    <link rel="icon" href="../image/logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
    
    <style>
        /* [START CLEAN & PROFESSIONAL CSS BLOCK] */
        :root {
            --primary-light: #81C784; --primary-main: #4CAF50; --primary-dark: #388E3C; 
            --accent-blue: #2196F3; --accent-orange: #FF9800; --accent-red: #D32F2F;
            --neutral-bg: #F0F2F5; /* Light Gray Background */
            --neutral-card: #FFFFFF;
            --text-dark: #333333; 
            --text-light: #666666; 
            --shadow-dashboard: 0 4px 12px rgba(0, 0, 0, 0.05);
            --font-sans: 'Helvetica Neue', Arial, sans-serif;
            --transition-speed: 0.3s;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: var(--font-sans); color: var(--text-dark); background-color: var(--neutral-bg); line-height: 1.6; display: flex; flex-direction: column; min-height: 100vh; }
        a { text-decoration: none; color: var(--primary-main); transition: color var(--transition-speed); }
        a:hover { color: var(--primary-dark); }
        main { flex-grow: 1; padding: 30px 0; }
        h1, h2 { color: var(--primary-dark); }
        .content-container { max-width: 1500px; margin: 0 auto; padding: 0 25px; } 

        /* Navigation Bar (Updated for Admin links) */
        #navbar { display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; background-color: var(--neutral-card); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000; }
        .logo-container { font-size: 1.5em; font-weight: bold; color: var(--text-dark); }
        .nav-links-container { display: flex; gap: 20px; align-items: center; }
        .cta-button { background-color: var(--primary-main); color: var(--neutral-card); border-radius: 5px; padding: 8px 15px; font-weight: bold; transition: background-color var(--transition-speed); }
        .cta-button:hover { background-color: var(--primary-dark); }

        /* TAB MANAGEMENT */
        .tab-bar-scroller { display: flex; flex-wrap: nowrap; overflow-x: auto; margin-bottom: 20px; border-bottom: 2px solid #ccc; scrollbar-width: none; /* Firefox */ }
        .tab-bar-scroller::-webkit-scrollbar { display: none; /* Chrome, Safari */ }
        .tab-button, .tab-link { 
            white-space: nowrap; /* Keep tabs on one line */
            background: #e9ecef; border: none; padding: 12px 18px; cursor: pointer; font-size: 0.95em; 
            font-weight: 500; border-top-left-radius: 8px; border-top-right-radius: 8px; 
            margin-right: 2px; transition: background 0.3s, color 0.3s; margin-bottom: -2px;
            color: var(--text-dark); text-decoration: none; display: flex; align-items: center; gap: 8px;
        }
        .tab-button.active, .tab-link.active { 
            background: var(--neutral-card); border: 1px solid #ccc; border-bottom: 2px solid var(--neutral-card); 
            color: var(--primary-dark); z-index: 10;
        }
        .tab-link:hover, .tab-button:hover { background: #dee2e6; }
        .tab-content { background: var(--neutral-card); padding: 30px; border-radius: 0 8px 8px 8px; box-shadow: var(--shadow-dashboard); min-height: 600px; }
        
        /* HOME STATS GRID */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { 
            background: var(--neutral-card); padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); 
            transition: transform 0.2s, box-shadow 0.2s; border-left: 5px solid var(--primary-main);
        }
        .stat-card:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); }
        .stat-card h3 { font-size: 1.1em; color: var(--text-light); margin-bottom: 10px; }
        .stat-card p { font-size: 2.2em; font-weight: bold; color: var(--primary-dark); }
        .stat-card .icon { font-size: 1.5em; float: right; color: var(--primary-light); }

        /* DATA TABLES */
        .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .data-table th, .data-table td { padding: 12px 15px; border-bottom: 1px solid #eee; text-align: left; font-size: 0.9em; }
        .data-table th { background-color: var(--primary-light); color: var(--text-dark); font-weight: 600; }
        .data-table tr:hover { background-color: #f8f9fa; }
        
        /* Actions & Status */
        .action-button { background-color: var(--accent-blue); color: white; border: none; padding: 6px 12px; cursor: pointer; border-radius: 4px; font-size: 0.8em; margin-top: 5px; display: block; width: 100%; text-align: center; }
        .action-button.reject { background-color: var(--accent-red); }
        .action-button:hover { opacity: 0.9; }

        .status-badge { padding: 4px 8px; border-radius: 12px; font-weight: bold; font-size: 0.75em; text-transform: uppercase; }
        .status-New, .status-Pending, .status-Assigned { background-color: var(--accent-orange); color: white; }
        .status-Approved, .status-Resolved, .status-Available { background-color: var(--primary-main); color: white; }
        .status-Rejected, .status-Closed, .status-OutofStock { background-color: var(--accent-red); color: white; }
        .status-Scheduled, .status-InReview { background-color: var(--accent-blue); color: white; }
        /* [END CLEAN & PROFESSIONAL CSS BLOCK] */
    </style>
    
    <script>
        const SUPABASE_URL = 'https://edotvuleaydztulkxehe.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkb3R2dWxlYXlkenR1bGt4ZWhlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU2MDAyNDYsImV4cCI6MjA4MTE3NjI0Nn0.gDni31MI8twOpNmNcIpj1jGsra75eZ2iLL6gQM0i9lw';
        let supabase;

        const ADMIN_ROLE_ID = 1;
        const STAFF_ROLES = [2, 3];
        
        // --- Utility Functions ---

        function formatDate(dateString) {
            return new Date(dateString).toLocaleString('en-US', {
                year: 'numeric', month: 'short', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
            });
        }
        
        function showLoading(bodyId, colspan, message = 'Fetching live data...') {
            const tbody = document.getElementById(bodyId);
            if(tbody) tbody.innerHTML = `<tr><td colspan="${colspan}" style="text-align: center; font-style: italic;">${message}</td></tr>`;
        }
        
        function updateStatusBadge(status) {
            return `<span class="status-badge status-${status.replace(/\s/g, '')}">${status}</span>`;
        }

        // --- Tab Management ---

        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tab-button, .tab-link').forEach(el => el.classList.remove('active'));

            const content = document.getElementById(tabName);
            if (content) content.style.display = 'block';

            const button = document.querySelector(`.tab-button[onclick="openTab('${tabName}')"]`);
            if (button) button.classList.add('active');

            // Trigger data fetch for the active tab
            if (tabName === 'home') {
                fetchStats();
            } else if (tabName === 'claims') {
                fetchClaims();
            } else if (tabName === 'donations') {
                fetchDonations();
            } else if (tabName === 'volunteers') {
                fetchVolunteers();
            } else if (tabName === 'inquiries') {
                fetchInquiries();
            } else if (tabName === 'settings') {
                fetchAnnouncement();
            }
        }
        
        // --- ACCESS CONTROL: Admin Only ---
        async function checkAccessAndRedirect() {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            const { data: { session }, error: sessionError } = await supabase.auth.getSession();
            
            if (sessionError || !session) {
                window.location.href = '/staff-login/index.html';
                return;
            }

            const userId = session.user.id;
            
            const { data: profileData, error: profileError } = await supabase
                .from('profiles')
                .select('role')
                .eq('id', userId)
                .single();
            
            // Check for the role (using your schema's 'role' column)
            if (profileError || !profileData || profileData.role !== ADMIN_ROLE_ID) {
                const userRole = profileData ? profileData.role : null;
                
                if (STAFF_ROLES.includes(userRole)) {
                    // Redirect Role 2/3 staff to their personal dashboard
                    window.location.href = '/staff/dashboard.html';
                } else {
                    await supabase.auth.signOut();
                    window.location.href = '/staff-login/index.html';
                }
                return;
            }

            // User is Admin (Role 1): Initialize dashboard content
            openTab('home');
        }

        // ==========================================================
        //                       DATA FETCH MODULES
        // ==========================================================

        // --- HOME / STATS MODULE (Uses RPC for real aggregate data) ---
        async function fetchStats() {
            // NOTE: You must create these functions (RPC) in your Supabase SQL Editor for accuracy.
            // Example: CREATE OR REPLACE FUNCTION get_pending_claims_count() RETURNS bigint LANGUAGE sql AS $$ SELECT count(*) FROM claims WHERE status = 'New' $$;

            const [
                { data: totalInventory, error: inventoryError },
                { data: pendingClaimsCount, error: claimsError },
                { data: newInquiriesCount, error: inquiriesError },
                { data: newDonationsCount, error: donationsError }
            ] = await Promise.all([
                supabase.rpc('get_total_inventory_items'), // Assume: SELECT sum(current_stock_count) FROM available_inventory
                supabase.rpc('get_pending_claims_count'),   // Assume: SELECT count(*) FROM claims WHERE status = 'New'
                supabase.rpc('get_new_inquiries_count'),    // Assume: SELECT count(*) FROM inquiries WHERE status = 'New'
                supabase.rpc('get_new_donations_count')     // Assume: SELECT count(*) FROM donations WHERE status = 'Pending'
            ]);

            document.getElementById('statTotalInventory').textContent = totalInventory ? totalInventory[0].sum : '0';
            document.getElementById('statPendingClaims').textContent = pendingClaimsCount ? pendingClaimsCount[0].count : '0';
            document.getElementById('statNewInquiries').textContent = newInquiriesCount ? newInquiriesCount[0].count : '0';
            document.getElementById('statNewDonations').textContent = newDonationsCount ? newDonationsCount[0].count : '0';

            if (inventoryError || claimsError || inquiriesError || donationsError) {
                console.error("Stats Error:", inventoryError || claimsError || inquiriesError || donationsError);
            }
        }


        // --- CLAIMS MODULE (Table: claims, Linked to food_listings) ---
        async function fetchClaims() {
            const claimsBody = document.getElementById('claimsTableBody');
            showLoading('claimsTableBody', 7);

            const { data: claims, error } = await supabase
                .from('claims')
                .select(`id, claimed_at, claimer_name, claimer_phone, claimer_email, status, method, transport_address, food_listings(title)`)
                .order('claimed_at', { ascending: false });

            if (error) { showLoading('claimsTableBody', 7, `Error: ${error.message}`); return; }
            if (claims.length === 0) { showLoading('claimsTableBody', 7, `No claims found.`); return; }

            claimsBody.innerHTML = claims.map(c => `
                <tr>
                    <td>${formatDate(c.claimed_at)}</td>
                    <td>${c.claimer_name}</td>
                    <td>${c.claimer_phone}</td>
                    <td>${c.food_listings ? c.food_listings.title : 'Listing Deleted'}</td>
                    <td>${c.method}</td>
                    <td>${c.transport_address || 'N/A'}</td>
                    <td>${updateStatusBadge(c.status)}</td>
                    <td>
                        <button class="action-button" onclick="updateStatus('claims', '${c.id}', 'Approved', ${c.status === 'New'})">Approve / Schedule</button>
                        <button class="action-button reject" onclick="updateStatus('claims', '${c.id}', 'Rejected', ${c.status === 'New'})">Reject</button>
                    </td>
                </tr>
            `).join('');
        }

        // --- DONATIONS MODULE (Table: donations) ---
        async function fetchDonations() {
            const donationsBody = document.getElementById('donationsTableBody');
            showLoading('donationsTableBody', 7);

            const { data: donations, error } = await supabase
                .from('donations')
                .select(`id, created_at, donor_name, donor_email, donor_phone, pickup_island, pickup_address, food_type, quantity_kg, status`)
                .order('created_at', { ascending: false });

            if (error) { showLoading('donationsTableBody', 7, `Error: ${error.message}`); return; }
            if (donations.length === 0) { showLoading('donationsTableBody', 7, `No donation requests found.`); return; }

            donationsBody.innerHTML = donations.map(d => `
                <tr>
                    <td>${formatDate(d.created_at)}</td>
                    <td>${d.donor_name}</td>
                    <td>${d.donor_phone}</td>
                    <td>${d.pickup_island}</td>
                    <td>${d.food_type} (${d.quantity_kg || 'N/A'} kg)</td>
                    <td>${d.pickup_address}</td>
                    <td>${updateStatusBadge(d.status)}</td>
                    <td>
                        <button class="action-button" onclick="updateStatus('donations', '${d.id}', 'Scheduled', ${d.status === 'Pending'})">Schedule Pickup</button>
                        <button class="action-button reject" onclick="updateStatus('donations', '${d.id}', 'Cancelled', ${d.status === 'Pending'})">Cancel Request</button>
                    </td>
                </tr>
            `).join('');
        }
        
        // --- VOLUNTEER MODULE (Table: volunteer_applications) ---
        async function fetchVolunteers() {
            const volunteersBody = document.getElementById('volunteersTableBody');
            showLoading('volunteersTableBody', 6);

            const { data: apps, error } = await supabase
                .from('volunteer_applications')
                .select(`id, submitted_at, full_name, email, phone, location_island, available_hours, application_status`)
                .order('submitted_at', { ascending: false });

            if (error) { showLoading('volunteersTableBody', 6, `Error: ${error.message}`); return; }
            if (apps.length === 0) { showLoading('volunteersTableBody', 6, `No volunteer applications found.`); return; }

            volunteersBody.innerHTML = apps.map(a => `
                <tr>
                    <td>${formatDate(a.submitted_at)}</td>
                    <td>${a.full_name}</td>
                    <td>${a.email}<br>${a.phone || 'N/A'}</td>
                    <td>${a.location_island}</td>
                    <td>${a.available_hours || 'N/A'}</td>
                    <td>${updateStatusBadge(a.application_status || 'New')}</td>
                    <td>
                        <button class="action-button" onclick="updateStatus('volunteer_applications', '${a.id}', 'Approved', ${a.application_status !== 'Approved'})">Approve</button>
                        <button class="action-button reject" onclick="updateStatus('volunteer_applications', '${a.id}', 'Rejected', ${a.application_status !== 'Rejected'})">Reject</button>
                    </td>
                </tr>
            `).join('');
        }

        // --- INQUIRIES MODULE (Table: inquiries) ---
        async function fetchInquiries() {
            const inquiriesBody = document.getElementById('inquiriesTableBody');
            showLoading('inquiriesTableBody', 6);

            const { data: inquiries, error } = await supabase
                .from('inquiries')
                .select(`id, received_at, sender_name, sender_email, subject, message, status`)
                .order('received_at', { ascending: false });

            if (error) { showLoading('inquiriesTableBody', 6, `Error: ${error.message}`); return; }
            if (inquiries.length === 0) { showLoading('inquiriesTableBody', 6, `No general inquiries found.`); return; }

            inquiriesBody.innerHTML = inquiries.map(i => `
                <tr>
                    <td>${formatDate(i.received_at)}</td>
                    <td>${i.sender_name}</td>
                    <td>${i.sender_email}</td>
                    <td>${i.subject}</td>
                    <td><div style="max-width: 250px; max-height: 50px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;">${i.message}</div></td>
                    <td>${updateStatusBadge(i.status)}</td>
                    <td>
                        <button class="action-button" onclick="updateStatus('inquiries', '${i.id}', 'Resolved', ${i.status !== 'Resolved'})">Resolve</button>
                        <button class="action-button reject" onclick="updateStatus('inquiries', '${i.id}', 'Closed', ${i.status !== 'Closed'})">Close</button>
                    </td>
                </tr>
            `).join('');
        }

        // --- SETTINGS MODULE (Table: settings) ---
        async function fetchAnnouncement() {
            const { data, error } = await supabase
                .from('settings')
                .select('*')
                .eq('key', 'public_announcement') // Using a fixed key for the banner text
                .limit(1)
                .single();

            if (error && error.code !== 'PGRST116') { 
                 console.warn("Could not fetch announcement:", error);
                 document.getElementById('announcementText').value = "Error loading previous announcement.";
                 return;
            }
            
            if (data) {
                document.getElementById('announcementText').value = data.value || '';
                document.getElementById('currentAnnouncementId').value = data.id;
            } else {
                 // Pre-populate for insert if no record exists
                 document.getElementById('announcementText').value = '';
                 document.getElementById('currentAnnouncementId').value = '';
            }
        }
        
        async function handleAnnouncementSubmit(event) {
            event.preventDefault();
            
            const content = document.getElementById('announcementText').value;
            const id = document.getElementById('currentAnnouncementId').value;
            
            const submitBtn = document.getElementById('announcementSubmitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Saving...';

            let response;

            if (id) {
                // Update existing setting
                response = await supabase
                    .from('settings')
                    .update({ value: content, updated_at: new Date() })
                    .eq('id', id);
            } else {
                // Insert new setting (First time)
                 response = await supabase
                    .from('settings')
                    .insert([{ key: 'public_announcement', value: content }]);
            }

            if (response.error) { 
                alert('Error updating Settings (Announcement): ' + response.error.message); 
            } else { 
                alert('Settings (Announcement) saved successfully!'); 
                // Refresh to ensure new ID is captured if it was an insert
                fetchAnnouncement();
            }

            submitBtn.disabled = false;
            submitBtn.textContent = 'Save Settings';
        }

        // --- GENERIC STATUS UPDATE ---
        async function updateStatus(tableName, id, newStatus, isConfirmRequired = true) {
            if (isConfirmRequired && !confirm(`Confirm change status of ID ${id.substring(0, 8)} to "${newStatus}" in the ${tableName} table?`)) {
                return;
            }
            
            const statusKey = tableName === 'volunteer_applications' ? 'application_status' : 'status';

            const { error } = await supabase
                .from(tableName)
                .update({ [statusKey]: newStatus })
                .eq('id', id);
                
            if (error) {
                alert(`Failed to update status in ${tableName}: ` + error.message);
            } else {
                // Refresh the appropriate table view
                if (tableName === 'claims') fetchClaims();
                else if (tableName === 'donations') fetchDonations();
                else if (tableName === 'volunteer_applications') fetchVolunteers();
                else if (tableName === 'inquiries') fetchInquiries();
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            checkAccessAndRedirect();
            // Attach listener for the Settings form
            const settingsForm = document.getElementById('settingsForm');
            if(settingsForm) settingsForm.addEventListener('submit', handleAnnouncementSubmit);
        });
    </script>
</head>
<body>
    <header id="navbar">
        <a href="/admin/dashboard.html" class="logo-container">
            <i class="fas fa-seedling" style="color: var(--primary-main);"></i> FoodShare <span style="font-weight: normal;">Admin Panel</span>
        </a>
        <nav class="nav-links-container" id="navLinks">
            <a onclick="supabase.auth.signOut().then(() => { window.location.href = '/staff-login/index.html'; })" class="cta-button" style="cursor: pointer;">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a> 
        </nav>
    </header>

    <main>
        <div class="content-container">
            <h1><i class="fas fa-tools"></i> Administrative Management Panel</h1>
            <p style="text-align: center; color: var(--accent-red); margin-bottom: 20px;">
                <i class="fas fa-lock"></i> **RESTRICTED ACCESS:** Live data from your Supabase Schema.
            </p>

            <div class="tab-bar-scroller">
                <button class="tab-button active" onclick="openTab('home')"><i class="fas fa-chart-line"></i> Home</button>
                <button class="tab-button" onclick="openTab('claims')"><i class="fas fa-hand-holding-heart"></i> Claims</button>
                <button class="tab-button" onclick="openTab('donations')"><i class="fas fa-truck-loading"></i> Donations</button>
                <button class="tab-button" onclick="openTab('volunteers')"><i class="fas fa-hands-helping"></i> Volunteer Applications</button>
                <button class="tab-button" onclick="openTab('inquiries')"><i class="fas fa-question-circle"></i> General Inquiries</button>
                <button class="tab-button" onclick="openTab('settings')"><i class="fas fa-cogs"></i> Settings</button>
                
                <a href="/admin/inventory-manage.html" class="tab-link"><i class="fas fa-boxes"></i> Inventory</a>
                <a href="/admin/user-manage.html" class="tab-link"><i class="fas fa-users-cog"></i> User Management</a>
                <a href="/admin/assign-task.html" class="tab-link"><i class="fas fa-tasks"></i> Assign Task</a>
            </div>
            
            <div id="home" class="tab-content">
                <h2>System Overview & Real-Time Metrics</h2>
                <p style="margin-bottom: 20px; color: var(--text-light);">Data fetched live from your tables: `available_inventory`, `claims`, `inquiries`, `donations`.</p>
                <div class="stats-grid">
                    <div class="stat-card" style="border-left-color: var(--primary-main);">
                        <i class="icon fas fa-boxes"></i>
                        <h3>Total Inventory Items (Current Stock)</h3>
                        <p id="statTotalInventory">...</p>
                    </div>
                    <div class="stat-card" style="border-left-color: var(--accent-red);">
                        <i class="icon fas fa-hand-holding-heart"></i>
                        <h3>Pending Claims</h3>
                        <p id="statPendingClaims">...</p>
                    </div>
                    <div class="stat-card" style="border-left-color: var(--accent-orange);">
                        <i class="icon fas fa-truck-loading"></i>
                        <h3>New Donation Requests</h3>
                        <p id="statNewDonations">...</p>
                    </div>
                    <div class="stat-card" style="border-left-color: var(--accent-blue);">
                        <i class="icon fas fa-question-circle"></i>
                        <h3>New General Inquiries</h3>
                        <p id="statNewInquiries">...</p>
                    </div>
                </div>
            </div>

            <div id="claims" class="tab-content" style="display:none;">
                <h2>Recent Food Claims Management</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Claim Date</th>
                            <th>Claimer Name</th>
                            <th>Phone</th>
                            <th>Item Claimed</th>
                            <th>Method</th>
                            <th>Address/Location</th>
                            <th>Status</th>
                            <th style="width: 150px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="claimsTableBody">
                        </tbody>
                </table>
            </div>

            <div id="donations" class="tab-content" style="display:none;">
                <h2>Incoming Donation Pickup Requests</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Donor Name</th>
                            <th>Contact</th>
                            <th>Island</th>
                            <th>Item/Qty</th>
                            <th>Pickup Address</th>
                            <th>Status</th>
                            <th style="width: 150px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="donationsTableBody">
                        </tbody>
                </table>
            </div>

            <div id="volunteers" class="tab-content" style="display:none;">
                <h2>Volunteer Applications Review</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Full Name</th>
                            <th>Contact Info</th>
                            <th>Island</th>
                            <th>Available Hours</th>
                            <th>Status</th>
                            <th style="width: 150px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="volunteersTableBody">
                        </tbody>
                </table>
            </div>
            
            <div id="inquiries" class="tab-content" style="display:none;">
                <h2>General Contact Inquiries (Table: `inquiries`)</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Received At</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Subject</th>
                            <th>Message Snippet</th>
                            <th>Status</th>
                            <th style="width: 100px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="inquiriesTableBody">
                        </tbody>
                </table>
            </div>

            <div id="settings" class="tab-content" style="display:none;">
                <h2>System Settings: Public Announcement Banner</h2>
                <p>Manage the main announcement shown to the public (stored in `public.settings`).</p>
                <form id="settingsForm" style="max-width: 600px; margin-top: 20px; padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
                    <input type="hidden" id="currentAnnouncementId" value="">

                    <label for="announcementText" style="display: block; font-weight: bold; margin-bottom: 5px;">Announcement Content</label>
                    <textarea id="announcementText" name="announcementText" rows="4" required placeholder="Enter the announcement text here..."></textarea>
                    
                    <button type="submit" id="announcementSubmitBtn" class="cta-button" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </form>
            </div>
            
            </div>
    </main>

    <footer id="main-footer" style="padding: 20px; background: #333; color: white; text-align: center;">
        <p>Â© 2025 Foodshare Seychelles. Admin Tools.</p>
    </footer>
</body>
</html>
